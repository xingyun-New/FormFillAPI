# FormFillAPI å¿«é€Ÿéƒ¨ç½²æŒ‡å—

## éƒ¨ç½²æ–¹å¼é€‰æ‹©

æ ¹æ®æ‚¨çš„éœ€æ±‚å’Œç¯å¢ƒï¼Œé€‰æ‹©æœ€é€‚åˆçš„éƒ¨ç½²æ–¹å¼ï¼š

| éƒ¨ç½²æ–¹å¼ | é€‚ç”¨åœºæ™¯ | éš¾åº¦ | æ¨èæŒ‡æ•° |
|---------|---------|------|---------|
| **Dockeréƒ¨ç½²** | å¿«é€Ÿéƒ¨ç½²ã€å¼€å‘æµ‹è¯• | â­ | â­â­â­â­â­ |
| **ä¼ ç»Ÿéƒ¨ç½²** | ç”Ÿäº§ç¯å¢ƒã€éœ€è¦ç²¾ç»†æ§åˆ¶ | â­â­â­ | â­â­â­â­ |
| **äº‘å¹³å°éƒ¨ç½²** | å¤§è§„æ¨¡ã€é«˜å¯ç”¨ | â­â­â­â­ | â­â­â­ |

---

## ğŸ³ æ–¹å¼1: Dockeréƒ¨ç½² (æ¨è)

### ä¼˜ç‚¹
- ä¸€é”®éƒ¨ç½²ï¼Œç¯å¢ƒéš”ç¦»
- åŒ…å«Nginxåå‘ä»£ç†
- è‡ªåŠ¨å¥åº·æ£€æŸ¥
- æ•°æ®æŒä¹…åŒ–

### ç¯å¢ƒè¦æ±‚
- Docker 20.0+
- Docker Compose 2.0+

### éƒ¨ç½²æ­¥éª¤

```bash
# 1. è¿›å…¥Dockeréƒ¨ç½²ç›®å½•
cd deploy/docker

# 2. ä¸€é”®éƒ¨ç½²
chmod +x docker-deploy.sh
./docker-deploy.sh

# 3. è®¿é—®åº”ç”¨
# HTTP: http://localhost
# API: http://localhost/api/health
```

### ç®¡ç†å‘½ä»¤

```bash
# æŸ¥çœ‹çŠ¶æ€
./docker-deploy.sh status

# æŸ¥çœ‹æ—¥å¿—
./docker-deploy.sh logs

# é‡å¯æœåŠ¡
./docker-deploy.sh restart

# åœæ­¢æœåŠ¡
./docker-deploy.sh stop
```

---

## ğŸ–¥ï¸ æ–¹å¼2: ä¼ ç»Ÿéƒ¨ç½²

### ä¼˜ç‚¹
- æ€§èƒ½æœ€ä¼˜
- èµ„æºåˆ©ç”¨ç‡é«˜
- ä¾¿äºè°ƒè¯•

### ç¯å¢ƒè¦æ±‚
- Java 17+
- Maven 3.6+
- Ubuntu 20.04+ / CentOS 7+

### éƒ¨ç½²æ­¥éª¤

```bash
# 1. æ£€æŸ¥ç¯å¢ƒ
chmod +x deploy/scripts/check-env.sh
./deploy/scripts/check-env.sh

# 2. ä¼ è¾“æ–‡ä»¶åˆ°æœåŠ¡å™¨
scp -r . user@your-server:/opt/formfillapi

# 3. åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
cd /opt/formfillapi
chmod +x deploy-all.sh
./deploy-all.sh
```

### è¯¦ç»†é…ç½®

å¦‚éœ€è¯¦ç»†é…ç½®ï¼Œè¯·å‚è€ƒï¼š[äº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—.md](äº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—.md)

---

## â˜ï¸ æ–¹å¼3: äº‘å¹³å°éƒ¨ç½²

### é˜¿é‡Œäº‘ECSéƒ¨ç½²

```bash
# 1. åˆ›å»ºECSå®ä¾‹ (Ubuntu 20.04, 2æ ¸4GB)
# 2. é…ç½®å®‰å…¨ç»„ (å¼€æ”¾80,443,8080ç«¯å£)
# 3. ä¸Šä¼ é¡¹ç›®æ–‡ä»¶
# 4. æ‰§è¡Œéƒ¨ç½²è„šæœ¬
```

### è…¾è®¯äº‘CVMéƒ¨ç½²

```bash
# 1. åˆ›å»ºCVMå®ä¾‹
# 2. é…ç½®é˜²ç«å¢™è§„åˆ™
# 3. ä½¿ç”¨ä¼ ç»Ÿéƒ¨ç½²æ–¹å¼
```

### AWS EC2éƒ¨ç½²

```bash
# 1. å¯åŠ¨EC2å®ä¾‹ (Ubuntu Server 20.04)
# 2. é…ç½®Security Groups
# 3. ä½¿ç”¨Dockeræˆ–ä¼ ç»Ÿæ–¹å¼éƒ¨ç½²
```

---

## ğŸš€ ä¸€é”®éƒ¨ç½²è„šæœ¬å¯¹æ¯”

### Dockerä¸€é”®éƒ¨ç½²
```bash
cd deploy/docker && ./docker-deploy.sh
```
**æ—¶é—´**: ~5åˆ†é’Ÿ  
**é€‚ç”¨**: å¼€å‘ã€æµ‹è¯•ã€å°è§„æ¨¡ç”Ÿäº§

### ä¼ ç»Ÿä¸€é”®éƒ¨ç½²
```bash
./deploy-all.sh
```
**æ—¶é—´**: ~10åˆ†é’Ÿ  
**é€‚ç”¨**: ç”Ÿäº§ç¯å¢ƒã€å¤§è§„æ¨¡éƒ¨ç½²

---

## ğŸ”§ éƒ¨ç½²åé…ç½®

### 1. åŸŸåé…ç½®

```bash
# ä¿®æ”¹Nginxé…ç½®
sudo nano /etc/nginx/sites-available/formfillapi
# å°† server_name æ”¹ä¸ºæ‚¨çš„åŸŸå

# é‡å¯Nginx
sudo systemctl reload nginx
```

### 2. SSLè¯ä¹¦é…ç½®

```bash
# å®‰è£…Certbot
sudo apt install certbot python3-certbot-nginx -y

# è·å–SSLè¯ä¹¦
sudo certbot --nginx -d your-domain.com

# è®¾ç½®è‡ªåŠ¨ç»­æœŸ
sudo crontab -e
# æ·»åŠ : 0 12 * * * /usr/bin/certbot renew --quiet
```

### 3. é˜²ç«å¢™é…ç½®

```bash
# Ubuntu UFW
sudo ufw allow ssh
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable

# CentOS Firewalld
sudo firewall-cmd --permanent --add-service=ssh
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### JVMè°ƒä¼˜
```bash
# ä¿®æ”¹å¯åŠ¨è„šæœ¬ä¸­çš„JVMå‚æ•°
JAVA_OPTS="-Xms2g -Xmx4g -XX:+UseG1GC"
```

### ç³»ç»Ÿä¼˜åŒ–
```bash
# å¢åŠ æ–‡ä»¶æè¿°ç¬¦é™åˆ¶
echo "* soft nofile 65536" >> /etc/security/limits.conf
echo "* hard nofile 65536" >> /etc/security/limits.conf
```

### æ•°æ®åº“ä¼˜åŒ–ï¼ˆå¦‚æœä½¿ç”¨ï¼‰
```bash
# å¦‚æœåç»­æ·»åŠ æ•°æ®åº“ï¼Œå¯ä»¥é…ç½®è¿æ¥æ± 
spring.datasource.hikari.maximum-pool-size=20
```

---

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ç«¯å£å†²çª
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep :8080

# ä¿®æ”¹ç«¯å£
# ç¼–è¾‘ application.yml ä¸­çš„ server.port
```

#### 2. å†…å­˜ä¸è¶³
```bash
# æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h

# è°ƒæ•´JVMå†…å­˜
# ä¿®æ”¹ JAVA_OPTS ä¸­çš„ -Xmx å‚æ•°
```

#### 3. æƒé™é—®é¢˜
```bash
# ä¿®å¤æ–‡ä»¶æƒé™
sudo chown -R formfill:formfill /opt/formfillapi
chmod 755 /opt/formfillapi/scripts/*.sh
```

#### 4. å¥åº·æ£€æŸ¥å¤±è´¥
```bash
# æ£€æŸ¥åº”ç”¨æ—¥å¿—
tail -f logs/formfill-api.log

# æ‰‹åŠ¨æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:8080/api/health
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# åº”ç”¨æ—¥å¿—
tail -f logs/formfill-api.log

# ç³»ç»ŸæœåŠ¡æ—¥å¿—
sudo journalctl -u formfillapi -f

# Dockeræ—¥å¿—
docker-compose logs -f formfillapi

# Nginxæ—¥å¿—
tail -f /var/log/nginx/formfillapi_access.log
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### æ–‡æ¡£é“¾æ¥
- [è¯¦ç»†éƒ¨ç½²æŒ‡å—](äº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—.md)
- [APIæ–‡æ¡£](../README.md)
- [Dockeréƒ¨ç½²](docker/)

### å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status formfillapi

# é‡å¯æœåŠ¡
sudo systemctl restart formfillapi

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f /opt/formfillapi/logs/formfill-api.log

# å¥åº·æ£€æŸ¥
curl http://localhost:8080/api/health

# æ›´æ–°åº”ç”¨
./scripts/deploy.sh
```

---

## ğŸ¯ æ€»ç»“

é€‰æ‹©æœ€é€‚åˆæ‚¨çš„éƒ¨ç½²æ–¹å¼ï¼š

- **å¿«é€Ÿä½“éªŒ**: ä½¿ç”¨Dockeréƒ¨ç½²
- **ç”Ÿäº§ç¯å¢ƒ**: ä½¿ç”¨ä¼ ç»Ÿéƒ¨ç½²
- **äº‘å¹³å°**: æ ¹æ®å¹³å°ç‰¹æ€§é€‰æ‹©æ–¹å¼

æ— è®ºé€‰æ‹©å“ªç§æ–¹å¼ï¼Œéƒ½æä¾›äº†å®Œæ•´çš„è„šæœ¬å’Œæ–‡æ¡£æ”¯æŒï¼Œç¡®ä¿æ‚¨èƒ½å¤Ÿé¡ºåˆ©éƒ¨ç½²FormFillAPIåˆ°äº‘æœåŠ¡å™¨ä¸Šã€‚ 